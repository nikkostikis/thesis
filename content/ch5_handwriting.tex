\chapter{Parkinson's Symptom Quantification via Simple Drawing and Handwriting Markers}
\label{ch:handwriting}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[OC]{\leftmark}
\fancyhead[EC]{\rightmark}
\cfoot{\thepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{General Approach}
\label{sec:PenGenApproach}
As discussed in section \ref{sec:handwriting}, handwriting-related tasks have been proven to work reasonably well in identifying and quantifying abnormal patterns in \gls{PD} patients. There are two phenomena defined and related with \gls{PD} pathology:

\begin{itemize}
\item Micrographia, which entails the reduction in size of the lettering of the writer in comparison with his writing style before the disease onset (Wilson, 1925). There are two types, the consistent micrographia, where there is a global reduction in lettering size, and the progressive, where the writer gradually produces smaller letters after writing a few characters. Micrographia has not been found to be directly related to any other particular \gls{PD} symptom. The consistent type is responsive to levodopa, whereas the progressive one is medication resistant. 
\item Dysgraphia, which includes any abnormal behavior in the mechanics of handwriting skills (Letanneux et al, 2014). Researchers believe that all motor impairments of \gls{PD}, such as the \gls{TRAP} complex, reduced visuospatial perception, and motor coordination deficiencies can actually contribute to pathological handwriting kinematics, in combination with and beyond writing size. 
\end{itemize}

\noindent
The dysgraphia ``umbrella'' term implies that the same motor impairments responsible for micrographia could manifest and be detectable through much simpler tasks than writing text, like drawing lines and shapes, and even when actual micrographia is not yet detectable. Given the fact that micrographia can already be detected up to four years earlier than the cardinal \gls{PD} symptoms like tremor or rigidity even becoming clinically observable, the general condition defined as dysgraphia could be a very promising measure for early detection. 

Of course, due to the simplistic nature of the tasks involved, dysgraphia assessment requires more sophisticated signal processing, feature extraction protocols and algorithms to be applied, in order to unveil and isolate the useful information using the simple drawing movements. Signal analysis must go beyond simply calculating stroke size and duration to identify discriminating characteristics and reveal early and subtle impairments.

Our approach to detect dysgraphia-related impairment was based on the following pillars: 

\begin{enumerate}
\item We focused on exploring the use of a simple off-the-shelf electronic device, such as a tablet digitizer attached to a consumer grade computer, with no exotic specifications or dedicated hardware required.  
\item We avoided requiring the users to follow any particular training to use our system. 
\item We devised a system that would not require the presence of an expert to use, but would still produce replicable and accurate symptoms quantification. 
\item We opted for a task that could be performed by both hands and would be simple enough to not be affected by the innate dexterity of the dominant hand.
\item To favor simplicity and ubiquity, we removed the complexity from the signal collection and focused instead on the signal processing protocol.  
\end{enumerate}
%I'm particularly proud of that list (!)
\noindent
To validate our dysgraphia quantification approach we conducted a clinical trial (\gls{PenCT}). It consisted of 24 patients with idiopathic \gls{PD}, defined as group \gls{PenPD}, 20 age-matched healthy volunteers, defined as group \gls{PenH}, and 15 younger healthy volunteers, defined as \gls{PenYH}.

The data collected were post-processed using signal processing techniques and statistically analyzed, to calculate quantifying metrics and establish their significance. We also experimented training and testing machine learning algorithms using the data collected, to be able to create rules for the metrics and classify new unlabeled trajectories as drawn by healthy individuals or \gls{PD} patients. 

In the following section we will describe the tablet-based clinical trial we conducted, present the data processing pipeline applied, and discuss the results obtained and the implications derived from our tablet-based \gls{PD} symptoms quantification approach. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{PenCT}
\label{sec:PenCT}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Protocol}
\label{subsec:PenCTProtocol}

\subsubsection{Rationale}
\label{subsubsec:PenCTRationale}
In section \ref{sec:handwriting} we reviewed the literature proving that handwriting and drawing tasks can be used to study human upper limb motor behavior and monitor movement disorders' symptoms in a quantitative way. 

Writing is a skill that is being developed later in a child's life. It involves a complex feedback system, integrating continuous information from the writing hand, i.e., proprioceptive sensory stimuli from all muscles involved, and sensory information from the fingers and the visual system. Also, free-hand text writing is a task that implicates the participation of various degrees of cognitive processes. In order to isolate the motor aspect of the writing task and investigate purely motor characteristics of handwriting, minimizing the involvement of any cognitive process that could affect the patient's performance, researchers have used the Archimedes spiral, single letters or simple words (Saunders-Pullman et al, 2008). In (Popovic et al, 2008) the authors showed that even simpler tasks, namely drawing point-to-point trajectories, contained useful features that helped detect motor blocks in \gls{PD} patients.

For our \gls{PenCT} study we designed a protocol that would use tasks stripped of cognitive involvement, as much as possible, easily executable with both hands, and requiring hardware equipment that would not be particularly special or difficult to acquire. We were interested in keeping the signal collection simple, fast, easy for elderly people, requiring minimum instruction and training, and suffering from low probability of erroneous execution. The layman's task would require the data processing to be sophisticated enough to extract metrics containing significant information, sufficient for classification. 

We explored the use of a simple line-drawing task. Line-drawing would be simpler than, for example, writing or drawing spirals, it would last only a few seconds, it would involve fewer muscular systems, no cognitive effort, and low coordination control effort. We hypothesized it would be unaffected by the dexterity of the volunteers' dominant hand, making it easy to perform using either right or left upper limb, which is not the case when writing letters or words. 

In \gls{PenCT} we aimed to investigate the kinematics of hand motion, measuring hand movement at a timescale where the volunteers would have little conscious control of the motion. That way, what we expected to detect was the balance of the tone of agonist versus antagonist muscular systems, which is altered in patients with \gls{PD}. We instructed our volunteers to draw simple horizontal lines, hypothesizing that any imbalance in agonist-antagonist coordination should be present even in simple drawings.

Another benefit of the selected task would be the bi-lateral, bi-directional execution capability, meaning the volunteers would be able to execute the task with both hands (hence bi-lateral), and activating different muscular systems by performing both extension and flexion motion patterns (hence bi-directional). 

We chose to conduct a control study and not a one-population validation study because there was lack of literature evidence that this simple free line drawing collection task would perform adequately, or even be robust enough for us to gather usable data. No other study had used such a simple task and we were uncertain of which exactly, if any, motor impairments would differentiate \gls{PD} patients' drawings from the lines drawn by healthy individuals. Our primary goal was to establish whether our approach could be used to identify motor impairments. 

The expected outcome of \gls{PenCT} was to evaluate the performance of a ubiquitous data collection tool with an unusually simple task on a small target population (\gls{PenPD}), examine the signals, calculate basic metrics and explore the statistical significance of the metrics when compared to a healthy control population (\gls{PenH}). 


\subsubsection{Volunteers}
\label{subsubsec:PenCTVolunteers}

Fifty-nine subjects in total participated in this study. All were right-handed, and had normal or corrected-to-normal vision. Their right-handedness was established based on what hand they used to write and eat with. The subjects agreed to participate in this study after a detailed explanation of its purposes and procedures. They were divided in three groups based on their health status and age (table \ref{table:demoPenCT1}). 

\begin{table}[h]
\centering
\caption{\textsc{Information on Volunteers' Grouping}}
\begin{tabular*}{1\textwidth}{@{\extracolsep{\fill}} c c c c }
	\multirow{2}{*}{\textit{Group}} & \multirow{2}{*}{Size}
	& \multicolumn{2}{c}{\textit{Age Statistics}} \\
	\cline{3-4}
	& & \textit{Mean$\pm$StD} & \textit{SE} \\
	\hline 	\hline 
	\textit{PenYH} & 15 & 36.4$\pm$5.94 & 1.53 \\
	\textit{PenH} & 20 & 66.35$\pm$7.91 & 1.61 \\
	\textit{PenPD} & 24 & 70.91$\pm$5.74 & 1.17 \\
 	\hline
 	\textit{Total} & 59 & & \\
\end{tabular*}
\label{table:demoPenCT1}
\end{table}

Group \gls{PenH} included 20 healthy persons aged 56-89. All subjects had a detailed neurological examination in order to screen for any movement disorders that would exclude them from the study. None had a first-degree relative with \gls{PD} or some kind of tremor. Also, none had hypertension or diabetes. Most of the healthy subjects came from retirement facilities.

Group \gls{PenPD} had 24 subjects aged 58-80, all under medication. They were recruited from the Parkinson's disease outpatient clinic of the 1st Neurology Department of the Aristotle University of Thessaloniki, Greece. All had been under periodic evaluation and levodopa and/or dopamine agonist treatment for more than a year. Undeniably, patients who are on medication improve on some of their clinical signs and symptoms. Nevertheless, even when a patient is on medication, most \gls{PD} signs and symptoms never disappear. The symptoms that are mostly alleviated are bradykinesia and rigidity, whereas tremor in most cases is ``drug-resistant''. Because \gls{PD} subjects participating in this study were all tested in an outpatient setting, they were kept on medication for ethical and safety reasons (i.e., drug deprivation could lead to injuries). Additionally, most of our patients were newly-diagnosed (but their Hoehn and Yahr rating was above 1) and were mostly well controlled without severe drug-induced dyskinesia. Their information is provided in table \ref{table:demoPenCT2}. Most of the patients comprising \gls{PenPD}, although with mean age above 70, could not be considered severe \gls{PD} cases. That could actually increase the importance of any good outcome of \gls{PenCT}, making our approach even more valuable for patients suffering from more severe symptoms. 

\begin{table}[!hp]
\centering
\caption{\textsc{Information on PenPD group}}
\begin{tabular*}{1\textwidth}{@{\extracolsep{\fill}} c c c c c c }
	\textit{Volunteers} & \textit{Age} & \textit{Sex} & \textit{UPDRS} & \textit{H\&Y} & \textit{Years from onset} \\
	\hline 	\hline 
 	\gls{PenPD}$_{1}$ & 70 & F & 9 & 2 & 2 \\
 	\gls{PenPD}$_{2}$ & 61 & M & 15 & 3 & 2 \\
 	\gls{PenPD}$_{3}$ & 63 & F & 13 & 2 & 2 \\
 	\gls{PenPD}$_{4}$ & 66 & F & 29 & 2.5 & 2 \\
 	\gls{PenPD}$_{5}$ & 75 & F & 8 & 2 & 2.5 \\
 	\gls{PenPD}$_{6}$ & 65 & F & 9 & 2 & 1.5 \\
 	\gls{PenPD}$_{7}$ & 78 & M & 23 & 3 & 3 \\
 	\gls{PenPD}$_{8}$ & 72 & M & 28 & 3 & 3 \\
 	\gls{PenPD}$_{9}$ & 69 & M & 15 & 2 & 3 \\
 	\gls{PenPD}$_{10}$ & 72 & M & 29 & 2 & 3 \\
 	\gls{PenPD}$_{11}$ & 72 & M & 19 & 2 & 2.5 \\
 	\gls{PenPD}$_{12}$ & 70 & M & 1 & 2 & 2 \\
 	\gls{PenPD}$_{13}$ & 75 & M & 11 & 2.5 & 2 \\
 	\gls{PenPD}$_{14}$ & 67 & M & 20 & 2 & 2 \\
 	\gls{PenPD}$_{15}$ & 72 & M & 25 & 3 & 4 \\
 	\gls{PenPD}$_{16}$ & 80 & M & 10 & 3 & 5 \\
 	\gls{PenPD}$_{17}$ & 66 & M & 7 & 3 & 2 \\
 	\gls{PenPD}$_{18}$ & 73 & M & 16 & 4 & 15 \\
 	\gls{PenPD}$_{19}$ & 74 & M & 23 & 4 & 14 \\
 	\gls{PenPD}$_{20}$ & 78 & M & 10 & 2 & 2.5 \\
 	\gls{PenPD}$_{21}$ & 79 & F & 14 & 2.5 & 3 \\
 	\gls{PenPD}$_{22}$ & 76 & F & 8 & 2.5 & 2 \\
 	\gls{PenPD}$_{23}$ & 71 & F & 4 & 2 & 2 \\
 	\gls{PenPD}$_{23}$ & 58 & M & 4 & 2 & 2 \\
 	& & & & & \\
	\multicolumn{6}{c}{The \gls{UPDRS} column contains a part III total score,} \\
	\multicolumn{6}{c}{where only upper limb components have been included} \\
\end{tabular*}
\label{table:demoPenCT2}
\end{table}

We introduced a third group of 15 young healthy volunteers (\gls{PenYH}) with a mean age 36.40 years. They were included in this study to establish a ``baseline'' for the various metrics, and their scores were compared to those of older healthy volunteers (\gls{PenH}) to test for possible age effects in our method.

The volunteers' ages for the groups \gls{PenH} and \gls{PenPD} were mean-tested at the 1\% significance level with the non-parametric Mann-Whitney U test and were not found to be statistically different, therefore the groups could be considered age-matched.

\subsubsection{Procedure and Hardware}
\label{subsubsec:PenCTProcHardware} 
Our hardware setup was based on a commercially available Wacom pen-tablet device, model Bamboo CTE-450, although any digital tablet would be suitable as well. Ours had an active surface of 147.6 x 92.3mm, a resolution of 100 dots per mm and a nominal report rate of 133Hz. The tablet would need to connect to a personal computer through a USB port (figure \ref{fig:penCTHW}). We developed custom software tools for data collection. The raw data consisted of the coordinates of the pen's tip (measured in screen pixels as they mapped to the tablet's dots per $mm^{2}$), recorded at a rate of 60Hz. Given the time scale involved in the movement of the upper limbs (including the hand/wrist) and the manifestations of \gls{PD}, which are in the under-10Hz range, anything above a 20Hz sampling rate seems to be sufficient to capture \gls{PD} impaired motion.

\begin{figure}[h]
\centering
  \includegraphics[width=0.9\linewidth]{content/images/pad/pad3}
\caption{The hardware setup of the \gls{PenCT}}
\label{fig:penCTHW}
\end{figure}

During each drawing session, the volunteer would sit at a desk, assuming a comfortable position to perform a normal writing task. The desk would be at approximately 70-80cm from the ground, with its surface extending just below the volunteer's celiac plexus. Whenever possible and necessary the height of the chair would be adjusted according to the following protocol:
\begin{itemize}
\item the volunteer would sit in front of the desk,
\item the volunteer would bend his elbows at 90 degrees, keeping his hands' palms facing up,
\item the height of the chair would be adjusted so that the dorsal part of the hands would sit comfortably on the surface of the desk, keeping the elbows bent at 90 degrees. 
\end{itemize}
\noindent
The Wacom tablet was connected to a laptop and placed in front of the volunteer. All participants were instructed to draw a horizontal line on the tablet's surface at a comfortable speed, keeping the pen's velocity as constant as possible throughout the task. While drawing, the volunteers were focused on the task, looking at the tablet, so there was no visual feedback of the line drawn. 

We instructed our volunteers to maintain a constant drawing speed profile, aiming to complete the drawing task at approximately 2 seconds, because the effects of \gls{PD} are dominant particularly at rest and during steady movements. All participants went through a practice phase where they drew a few lines and familiarized themselves with the procedure. The movement was such that the hand was away from the body, and the forearm was not supported by the table or the tablet; the only contact with the tablet's surface was through the pen, and subjects were instructed to draw with their wrist fixed in relation to the forearm. All volunteers were asked to draw the horizontal lines at least 10 times for each hand, left and right, and each direction, left-to-right and right-to-left, flexing or extending the elbow, resulting in a set of 40 recordings per session. The lines drawn were approximately 145mm long, which was determined by the effective area of the tablet. We opted to discard the initial and final data, i.e., about 10mm at the start and the end of the line drawn, taking into consideration only the middle 125mm of the line, because we wanted to focus on the intentionally steady portion of the movement without the initial and final acceleration and deceleration effects. 

Throughout \gls{PenCT}, every time a patient participated in a session, an experienced neurologist would perform a full \gls{UPDRS} examination before the recording. The neurologist was the same for every patient, so no interrater variability should be taken into account. Although it would be better to have a second neurologist evaluate the patients and assign \gls{UPDRS} scores, time and availability limitations prevented multiple raters for all patients, and the sessions were not recorded to allow for post-annotation.
  
\subsubsection{Software}
\label{subsubsec:PenCTSoftware}
Custom software was developed to collect the digital trajectories of the drawing tasks completed by the volunteers in \gls{PenCT}. The \gls{PenPD} and \gls{PenYH} volunteers' signals were collected using a Windows desktop application developed in Delphi. The signal sampling rate was the tablet's nominal 133Hz, i.e., the application recorded the position of the pen on the tablet once every 7.5ms. A Windows laptop was used to connect the Wacom tablet. The \gls{PenH} volunteers' signals were collected using a MATLAB application running on a MacBook Pro laptop. The signal collection was limited by the screen's refresh rate which was 60Hz, recording the position of the pen on the screen and tablet once every 16.6ms. To keep the signals comparable we downsampled the signals collected at a higher rate down to 60Hz. Both applications used the same Wacom tablet installed with the official driver released by Wacom, and had the pen configured to function like a mouse. Also, both laptops had the same screen resolution, 1280x800 pixels. During the signal collection, the Windows application's screen would turn black, providing no visual feedback of the task. The MATLAB application showed the line drawn on the screen but during the sessions only the clinical trial associate conductor was facing the laptop's screen, which was out of the sight of the volunteers. Therefore we assume no visual feedback was offered to the subjects by both signal collection setups. Both applications recorded timestamps along with the $x$-axis and $y$-axis pixel coordinates corresponding to the trace of the lines drawn during the sessions. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Data Collected}
\label{subsec:PenCTData}
The signals were collected at 60Hz, resulting in one recorded point per 16ms, for the total duration of the line-drawing task. Each recorded point was initially recorded by the tablet expressed in tuples of $(x,y)$ screen pixel coordinates. Although in our case the horizontal resolution of all the computers used was 1280 pixels, the data processing was built to be resolution-agnostic, scaling the pixel points recorded to match centimeters on the tablet. 

As discussed in paragraph \ref{subsubsec:PenCTProcHardware}, volunteers were instructed to draw at least 40 lines maintaining steady speed, in about 2 seconds. In reality, their drawing times fell between 1.5 and 3.5 seconds. Having cut the initial (acceleration) and final (deceleration) portions of the line (150 pixels at the start and end) resulted in 1.47 seconds average time for the \gls{PenH} group and 3.2 seconds for the \gls{PenPD} group. That means the signals of the \gls{PenH} group had average cardinality $N=88$, whereas the \gls{PenPD} group had average cardinality $N=190$. 

To quantify each volunteer's performance we first collected their tablet coordinates tuples along with a timestamp per sample. The sequence of samples in each volunteer's digitized path on the tablet along the horizontal and vertical direction is defined as $s(i) = (t(i),x(i),y(i))$, where $i = 1...N$, $t(i)$ starts at 0 and increments at 16ms per sample, and $(x(i),y(i))$ is the tuple of cm coordinates on the tablet's surface, translated from the screen pixels, according to the screen's resolution. The temporal interval in seconds is defined as $\Delta t = t(i)-t(i-1)$, where $i = 2...N$, which was so close to 16ms, it could be considered constant, and the total duration in seconds $T = t(N)-t(1)$. We computed the pen's horizontal velocity along the path by calculating for each point the absolute value of horizontal displacement over the change in time $v(i)=|(x(i)-x(i-1))|/(t(i)-t(i-1))$, essentially $v(i)=|(x(i)-x(i-1))|/0.0160$, where $i = 2...N$, and calculated each volunteer's path score vector, consisting of the following metrics:

%Equations

\begin{equation} \label{eq: MV}
MV = \frac{1}{N-1}\sum_{i=2}^{N}v(i)
\end{equation}

\begin{equation} \label{eq: NVV}
NVV = \frac{1}{T|MV|}10^{-3}\sum_{i=2}^{N-1}|v(i) - v(i-1)|
\end{equation}

\begin{equation} \label{eq: SDV}
SDV = \sqrt{\frac{1}{N-1}\sum_{i=2}^{N}|v(i)-MV|^{2}}
\end{equation}

\begin{equation} \label{eq: ETPv}
ETPv = -\sum_{i=1}^{N-1}P(v(i))\log_{2}(P(v(i)))
\end{equation}

\begin{equation} \label{eq: ETPy}
ETPy = -\sum_{i=1}^{N}P(y(i))\log_{2}(P(y(i)))
\end{equation}

\noindent
The $MV$ (\ref{eq: MV}) represents the mean horizontal ($x$-axis) velocity of each drawn trace, expressed in $cm/s$. The cardinality of the $v(i)$ vector is $N-1$. The $SDV$ (\ref{eq: SDV}) is the standard deviation of the horizontal ($x$-axis) velocity, also expressed in $cm/s$. The $NVV$ (\ref{eq: NVV}) quantifies the horizontal ($x$-axis) velocity variability of each trace, expressed in $1000/s$. The summation cardinality in (\ref{eq: NVV}) is $N-2$ because it sums over differences in between the elements of $v(i)$. Finally, the $ETP$ metrics quantify each trace's horizontal velocity entropy (\ref{eq: ETPv}) and vertical ($y$-axis) displacement entropy (\ref{eq: ETPy}) respectively. 

Signal entropy is a measure of disorder or uncertainty. We used the entropy of the horizontal velocity and the vertical displacement because these quantities would have low entropy due to minimal variability and deterministic nature if the line drawing motion was uniform, and higher entropy otherwise. To perform the calculation of the entropy a probability density function was required. The histogram of the values of the signal was used as an estimator for the probability density. Instead of choosing a number of bins for the histogram based on the length of the signal (i.e., square root rule or Sturges formula) or an arbitrary bin width, for each signal we created an alphabet, consisting of all the unique values in it. To avoid unnecessarily many values that would essentially be indistinguishable, but calculate misleadingly high entropies, we rounded the signals at 4 decimal digits. One of the reasons we did not use the entropy of the $x$-axis displacement was that we would end up with a dictionary containing all of the samples, whereas the velocity and the vertical displacement would most likely revolve around a small number of values per line drawn. Ultimately, the probability of each unique value would simply be the number of occurrences divided by the number of the signal samples. Both \ref{eq: ETPv} and \ref{eq: ETPy} use the binary logarithm and therefore are expressed in bits, with a higher number denoting a more information-rich signal, and hence, a higher variability in horizontal velocity or $y$-axis points visited line-drawing motion, respectively. 

\begin{figure}[h]
\centering
  \includegraphics[width=1\linewidth]{content/images/yCorrection/P1000004_1000004_E_L_11_Rotation_ComingFrom_yTrajectoryCorrection}
\caption{$y$-axis transformation}
\label{fig:yCorrection}
\end{figure}

To compensate for variability in the $y$-axis due to the positioning of the tablet during a session, a linear transformation was performed on the $y$-axis slightly rotating the trace (figure \ref{fig:yCorrection}), resulting in the corrected $\bar{y}(i)$ vector. The metric calculated from the transformed trace was considered a new variant of the $ETPy$ metric defined in \ref{eq: ETPyRot} not a replacement for \ref{eq: ETPy} because we could not be sure that the variability in the $y$-axis should be attributed to the skewed physical placement of the tablet during recording or to the actual movement of the participant. 

\begin{equation} \label{eq: ETPyRot}
ETP\bar{y} = -\sum_{i=1}^{N}P(\bar{y}(i))\log_{2}(P(\bar{y}(i)))
\end{equation}

To perform the rotation for each signal:
\begin{enumerate}
\item the starting and ending point was identified,
\item the linear relationship between the two points in the form of a linear equation of the form $y = {\alpha}x+{\beta}$ was calculated,
\item the angle between the $x$-axis and the linear equation was calculated as the negative (i.e., counter clock-wise rotation) inverse tangent of the slope ${\alpha}$, ${\theta}=-\arctan{\alpha}$,
\item the starting point was translated to $(0,0)$,
\item the transformation matrix was calculated
\begin{equation}
\begin{pmatrix}
\cos{\theta} & -\sin{\theta} \\
\sin{\theta} & \cos{\theta}
\end{pmatrix}
\end{equation}
\item the rotation was performed and the starting point was translated back to its original coordinates. 
\end{enumerate}
The rotation performed for the signals collected from the \gls{PenPD} population had an average $1.58^{\circ}$, whereas the corresponding mean for the \gls{PenH} population was $1.12^{\circ}$, so the actual rotation per trace was small, but we thought it was worth investigating this as a new base for entropy calculation. 

Choosing to calculate the metrics (\ref{eq: MV})-(\ref{eq: ETPyRot}) to characterize the pen's trace in a spatiotemporal manner was based on the hypothesis that due to impaired coordination in patients with movement disorders, certain features, such as the velocity profile of the pen's tip or the ``excursions'' from the vertical, should be more pronounced compared to healthy subjects. Ideally, according to our hypothesis metrics based on variability should be statistically different between the two groups. Previous research had proven that velocity- and acceleration-based metrics of voluntary movements could separate pathological from healthy subjects. In (Broderick et al, 2009) \gls{PD} patients showed a reduced ability to modulate acceleration, leading to smaller than required movements and micrographia, and (Contreras-Vidal and Stelmach, 1995) showed  that dopamine depletion in \gls{PD} leads to smaller than normal pallidothalamic gating signals, which in turn would affect the ability to control movement speed. The variability in handwriting velocity in patients with \gls{PD} was also noted in (Van Gemmert et al, 2003), where the patients showed multiple peaks in their velocity signal whereas the controls showed just one peak. Further backing our hypothesis, in (Eichhorn et al, 1996), the velocity and acceleration profiles of \gls{PD} patients were different in relation to healthy subjects while writing circles. Finally, in a different experimental design investigating the effect of dopamine on handwriting movements, the authors of (Tucha et al, 2005) found lower values for maximum and minimum velocity in ascending and descending strokes in \gls{PD} patients than in healthy subjects. They also found that patients had significantly more inversions of velocity and acceleration than healthy people. There was also a difference between patients ON medication and OFF medication, where the number of inversions in velocity and acceleration was statistically significant. 

In \gls{PenCT}, we expected to observe smoother movements incur a lower $NVV$, $SDV$ and $ETP$-based metrics, compared to more irregular movements. For example, a trajectory with constant horizontal velocity the would have $NVV$ and $SDV$ equal to zero.

For each line drawn we calculated the score vector ((\ref{eq: MV})-(\ref{eq: ETPyRot})). Then, for each volunteer we averaged each metric of the score vector in different subsets, selecting specific recordings of the total (about 40) performed in each session. 
For the following paragraphs we hereby define six different aggregation and averaging profiles for each of the metrics in the score vector: 

\begin{itemize}
\item ALL, where the value is a mean over all of a volunteer's recordings,
\item LH, where the value is a mean over the volunteer's lowest-scoring hand for the specific metric,
\item HH, where the value is a mean over the volunteer's highest-scoring hand for the specific metric,
\item HLH, where the value is a mean over the difference between highest- and lowest-scoring hand for the specific metric, i.e. HH-LH,
\item LD, where the value is a mean over the volunteer's lowest-scoring direction for the specific metric, i.e. flexion or extension, and
\item HD, where the value is a mean over the volunteer's highest-scoring direction for the specific metric, i.e. flexion or extension.
\end{itemize}

These averaging profiles are used as subscripts on the metrics of the score vector, to denote the recordings included to calculate the value, e.g., $NVV_{HH}$ corresponds to applying the calculation of (\ref{eq: NVV}) to all recordings of a volunteer, averaging over each hand separately and keeping only the values of the highest scoring hand. Lack of profile subscript implies averaging over ALL recordings. To denote axis and aggregation profile a notation like $ETPy_{LD}$ is used. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Data Analysis}
\label{subsec:PenCTAnalysis}
The $NVV$ metric defined in \ref{eq: NVV} is novel and less explored in the context of movement disorders compared to the other metrics and handwriting markers calculated, i.e., $MV$ (\ref{eq: MV}) and $ETP$ (\ref{eq: ETPv})-(\ref{eq: ETPyRot}), which have been used with success in (Eichhorn et al, 1996), (Tucha et al, 2005), (Liu et al, 2005), and (Drotar et al, 2014). At a neurological functional level, we expected differences in $NVV$ scores between the \gls{PenPD} and \gls{PenH} groups, based on the fact that the substantia nigra is a key structure participating in the regulation of the muscular tone (Korchounov et al, 2010). The $NVV$ attempts to capture some expression of the balance, or lack thereof, of the muscular tone between opposing muscular systems, given the fact that low-level control of those systems occurs on a time scale which is on the order of milliseconds, while conscious control of movement cannot be done at such high a frequency. 

Later in this chapter, we perform a classification analysis to validate our assumptions. Before using the $NVV$ as a potential classification feature, we conducted a preliminary normality and statistical significance analysis regarding the $NVV$ and all other scores between the \gls{PenPD} and \gls{PenH} groups. 

In the following paragraphs, a series of statistical tests on the data collected is described. In the tables, unless stated otherwise using a profile subscript (see paragraph \ref{subsec:PenCTData}), the calculations of metrics were based on average values over all sessions of each volunteer. The confidence level ($p$-value threshold) for all tests, unless stated otherwise, was set to $1\%$.

\subsubsection{Normality Testing}
\label{subsubsec:PenCTNormalityTesting}
We tested our data for normality with the Jarque-Berra and Liliefors tests, using all metrics and aggregation profiles (see \ref{subsec:PenCTData}). The MATLAB implementations \codeword{jbtest}\footnote{Jarque-Bera test - MATLAB jbtest, accessed Jul 23, 2018 at: https://www.mathworks.com/help/stats/jbtest.html.} and \codeword{lillietest}\footnote{Lilliefors test - MATLAB lillietest, accessed Jul 23, 2018, at: https://www.mathworks.com/help/stats/lillietest.html.} were used respectively, with $99\%$ confidence level. These tests were used to establish whether data could be assumed to fit the normal distribution with $99\%$ confidence. When results were contradictory, the distribution was considered as not normal. 

In the following tables (\ref{table:PenCTNormalityVelocity}-\ref{table:PenCTNormalityEntropy}) normality for each metric ((\ref{eq: MV})-(\ref{eq: ETPyRot})) for \gls{PenPD} and \gls{PenH} along with mean values and standard deviations is presented.

%%%%%% Normality, Mean and StD
\begin{table}[h]
\centering
\caption{\textsc{Normality of Data for Velocity-based Metrics}}
\begin{tabular*}{1\textwidth}{@{\extracolsep{\fill}} c | c  c  c  c  c  c  c  c}
	& {\textit{ALL}} & {\textit{LH}} & {\textit{HH}} & {\textit{HLH}} & {\textit{LD}} & {\textit{HD}} & {\textit{L}} & {\textit{R}} \\
	\cline{2-9} 
	\cline{2-9} 
	& {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} \\
	& {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} \\
	& {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} \\
	\cline{2-9}
	%%
	\\
	& \multicolumn{8}{c}{\textit{Normality of Data for Metric $MV$ (\ref{eq: MV})}} \\
	\hline 	\hline
	& 10.99 & 10.22 & 11.74 & 1.51 & 9.46 & 12.69 & 11.02 & 10.93 \\
	{\textit{PenH}} & 5.95 & 5.75 & 6.20 & 1.16 & 5.44 & 6.58 & 6.22 & 5.82 \\
	& Yes & Yes & Yes & Yes & Yes & Yes & Yes & Yes \\
	\hline
	& 4.12 & 3.56 & 4.60 & 1.04 & 3.26 & 5.10 & 3.69 & 4.47 \\
	{\textit{PenPD}} & 1.22 & 1.17 & 1.43 & 1.09 & 1.12 & 1.40 & 1.18 & 1.51 \\
	& Yes & Yes & Yes & No & Yes & Yes & Yes & Yes \\
	%%
	\\
	& \multicolumn{8}{c}{\textit{Normality of Data for Metric $NVV$ (\ref{eq: NVV})}} \\
	\hline 	\hline
	& 0.014 & 0.013 & 0.014 & 0 & 0.013 & 0.014 & 0.014 & 0.014 \\
	{\textit{PenH}} & 0.0007 & 0.0007 & 0.0007 & 0.0004 & 0.0006 & 0.0008 & 0.0008 & 0.0008 \\
	& Yes & Yes & Yes & Yes & Yes & Yes & Yes & Yes \\
	\hline
	& 0.017 & 0.016 & 0.018 & 0.002 & 0.015 & 0.019 & 0.016 & 0.017 \\
	{\textit{PenPD}} & 0.003 & 0.002 & 0.004 & 0.002 & 0.002 & 0.005 & 0.002 & 0.005 \\
	& No & No & No & No & Yes & No & No & No \\
	%%
	\\
	& \multicolumn{8}{c}{\textit{Normality of Data for Metric $SDV$ (\ref{eq: SDV})}} \\
	\hline 	\hline
	&  2.86 & 2.63 & 3.08 & 0.45 & 2.41 & 3.33 & 2.90 & 2.81 \\
	{\textit{PenH}} & 1.29 & 1.22 & 1.38 & 0.30 & 1.13 & 1.46 & 1.38 & 1.25 \\
	& Yes & Yes & Yes & Yes & Yes & Yes & Yes & Yes \\
	\hline
	& 1.71 & 1.40 & 1.98 & 0.58 & 1.30 & 2.22 & 1.43 & 1.95 \\
	{\textit{PenPD}} & 0.68 & 0.52 & 0.92 & 0.68 & 0.48 & 0.99 & 0.52 & 0.94 \\
	& Yes & Yes & No & No & Yes & Yes & Yes & Yes \\
\end{tabular*}
\label{table:PenCTNormalityVelocity}
\end{table}

\begin{table}[h]
\centering
\caption{\textsc{Normality of Data for Entropy-based Metrics}}
\begin{tabular*}{1\textwidth}{@{\extracolsep{\fill}} c | c  c  c  c  c  c  c  c}
	& {\textit{ALL}} & {\textit{LH}} & {\textit{HH}} & {\textit{HLH}} & {\textit{LD}} & {\textit{HD}} & {\textit{L}} & {\textit{R}} \\
	\cline{2-9} 
	\cline{2-9} 
	& {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} & {\textit{Mean}} \\
	& {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} & {\textit{StD}} \\
	& {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} & {\textit{Normal}} \\
	\cline{2-9}
	%%
	\\
	& \multicolumn{8}{c}{\textit{Normality of Data for Metric $ETPv$ (\ref{eq: ETPv})}} \\
	\hline 	\hline
	& 3.29 & 3.2 & 3.36 & 0.15 & 3.14 & 3.46 & 3.3 & 3.27 \\
	{\textit{PenH}} & 0.37 & 0.36 & 0.39 & 0.1 & 0.36 & 0.4 & 0.4 & 0.37 \\
	& Yes & Yes & Yes & Yes & Yes & Yes & No & Yes \\
	\hline
	& 2.9 & 2.73 & 3.06 & 0.33 & 2.64 & 3.18 & 2.76 & 3.03 \\
	{\textit{PenPD}} & 0.49 & 0.44 & 0.5 & 0.28 & 0.45 & 0.51 & 0.44 & 0.53 \\
	& Yes & Yes & Yes & No & Yes & Yes & Yes & Yes \\
	%%
	\\
	& \multicolumn{8}{c}{\textit{Normality of Data for Metric $ETPy$ (\ref{eq: ETPy})}} \\
	\hline 	\hline
	& 3.93 & 3.85 & 4.02 & 0.16 & 3.64 & 4.22 & 3.99 & 3.88 \\
	{\textit{PenH}} & 0.20 & 0.19 & 0.23 & 0.12 & 0.25 & 0.30 & 0.24 & 0.20 \\
	& Yes & Yes & Yes & No & Yes & No & Yes & Yes \\
	\hline
	& 4.44 & 4.29 & 4.62 & 0.32 & 4.12 & 4.81 & 4.55 & 4.36 \\
	{\textit{PenPD}} & 0.32 & 0.36 & 0.35 & 0.32 & 0.36 & 0.41 & 0.4 & 0.36 \\
	& Yes & Yes & Yes & No & Yes & Yes & Yes & Yes \\
	%%
	\\
	& \multicolumn{8}{c}{\textit{Normality of Data for Metric $ETP\bar{y}$ (\ref{eq: ETPyRot})}} \\
	\hline 	\hline
	& 6.1 & 5.97 & 6.24 & 0.27 & 5.84 & 6.35 & 6.1 & 6.1 \\
	{\textit{PenH}} & 0.87 & 0.87 & 0.88 & 0.2 & 0.82 & 0.86 & 0.96 & 0.8 \\
	& Yes & Yes & Yes & Yes & Yes & Yes & Yes & Yes \\
	\hline
	& 7.39 & 7.22 & 7.58 & 0.35 & 7.05 & 7.71 & 7.52 & 7.28 \\
	{\textit{PenPD}} & 0.38 & 0.36 & 0.45 & 0.26 & 0.34 & 0.44 & 0.44 & 0.42 \\
	& Yes & Yes & Yes & Yes & Yes & Yes & Yes & Yes \\
	\end{tabular*}
\label{table:PenCTNormalityEntropy}
\end{table}

\subsubsection{Significance Testing}
\label{subsubsec:PenCTSignificanceTesting}
The significance of each metric, both the velocity-based and the entropy-based ones would be later explored through the feature selection and classification algorithms. However, in this stage we performed means testing for all metrics and aggregation profiles to examine whether a randomly selected value from the \gls{PenPD} sample would be expected to be significantly different than a randomly selected value from the \gls{PenH} sample. Preliminary variance equality tests, such as the Brown-Forsythe (Brown and Forsythe, 1974) test, would either lead us to a Student pooled variances $t$ test or a Welch $t$ test with separate variances (Welch, 1947). Although a common practice in older papers, we decided to skip the homoscedasticity testing because as shown in (Zimmerman, 2004), when normality is satisfied, going directly for a Welch $t$ test and not pooling variances, actually produces better Type I and Type II error probabilities. 

Therefore, when both samples were normally distributed we used the two-tailed Welch $t$ test, as implemented in MATLAB with the function \codeword{ttest2}\footnote{Two-sample t-test - MATLAB ttest2, accessed Aug 30, 2018 at: https://www.mathworks.com/help/stats/ttest2.html.}, setting its \codeword{`Vartype'} flag to \codeword{`unequal'}. For inter-population comparisons where at least one of the samples was not normally distributed, the non-parametric two-tailed Mann-Whitney test was used, as implemented in MATLAB with the function \codeword{ranksum}\footnote{Wilcoxon rank sum test - MATLAB ranksum, accessed Aug 30, 2018 at: https://www.mathworks.com/help/stats/ranksum.html.}. 

In the following tables () the results from means testing are presented. The $p$-values are included to illustrate whether the decision for significant or non-significant differences was a close one, with confidence level $99\%$.

 


%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>
%%------------------------------------------------------------------------------------>>>>>>>>>>>>>>>>>>>>>>>>>>>

\subsubsection{Duration and Velocity Correlation Testing}
\label{subsubsec:PenCTDurVelCorTesting}
Scaling the velocity with which a path is traversed leaves the $NVV$ invariant, by definition. This is also borne out experimentally, in the fact that there was no correlation found between the duration of each effort and its $NVV$ score. We calculated the Pearson's correlation coefficient $r$, as the fraction of the covariance between the $NVV$ of each signal and the signal's duration, over the product of their standard deviations. 

\begin{equation} \label{eq:penPearson}
r = \frac{ \sum_{i=1}^{23} (x_{i} - \bar{x})(u_{i} - \bar{u}) } 
		 { \sqrt{\sum_{i=1}^{23} (x_{i} - \bar{x})^{2}} \sqrt{\sum_{i=1}^{23} (u_{i} - \bar{u})^{2}} }
\end{equation}

\noindent
This fraction, in theory, could take values ranging from $-1$, for total negative linear correlation between the metric and the duration, to $+1$ for total positive linear correlation. In (\ref{eq:penPearson}), $x_{i}$ abstractly denotes each one of the signal metrics, with $i$ being each patient and $\bar{x}$ the sample mean, and $u_{i}$ denotes the corresponding \gls{UPDRS} score of each patient, with $\bar{u}$ the sample mean.

and ($r=0.11$ with $p<0.001$ for \gls{PenH} and $r= -0.06$ with $p=0.04$ for \gls{PenPD}, where $r$ is the Pearson product-moment correlation coefficient calculated for effort duration and $NVV$ score). 

\subsubsection{Laterality Testing}
\label{subsubsec:PenCTLateralityTesting}

\subsubsection{UPDRS Correlation Testing}
\label{subsubsec:PenCTUPDRSCorTesting}

\subsubsection{Age Effects Testing}
\label{subsubsec:PenCTAgeEffectsTesting}

The NVV value of healthy people is also not affected by their age. Using means testing for YH and H groups we found no significant differences between the two healthy subgroups’ NVV values. Although aging is accompanying with a deterioration of the performances of the various components of the central nervous system, the NVV shows that the coordination between agonists and antagonists is well preserved, at least in the upper limbs.
By examining the NVV values between PD and H groups we found that the NVV means for the PD group were not normally distributed for all six components described in Section II.C, whereas the NVV means for the H group were normally distributed for every component. 
We found statistically significant differences between the PD and H populations’ NVV mean scores for components ALL, HH, HD, LD, HLH, suggesting that there is no overlap in the NVV measures of the two health-status-related groups. 
In general, the symptoms of PD appear with different intensity between the patient’s two sides (left-right). We were interested in exploring if the NVV values would reflect the laterality of the patients. 
We found that there was 1 out of 20 (5\%) healthy subject with a statistically significant difference between his two hands. The corresponding proportion in the PD group was 14 out of 24 (58\%). Although the populations do not satisfy the standard binomial requirement and we cannot determine the significance of the difference between these two percentages, their values are not close. The NVV detected the pathology laterality correctly for the same 58\% of the patients. That means that the clinically observed (through UPDRS evaluation) most affected hand matched the NVV identified highest-performing hand for 14 out of 24 PD patients.
The fact that we found no significant difference between hands for 19 of 20 healthy subjects (95\%) is to be expected. The NVV index is an expression of the balance between agonists-antagonists muscular systems and this balance is similar in both sides, considering good health. On the other side, we found that within the PD group the means are statistically significantly different for the HH and LH components. Combined with the significant difference in the means of the NVVHLH component between H and PD detected earlier, this means that the NVV difference between hands, is a kind of marker of the disease and that will be useful for the classification later on. 
NVVHLH values are the differences in NVV between the highest and lowest performing hand for each subject. Having established that there is a statistically significant difference in NVVHLH values between the H and PD groups (the latter group having on average higher NVVHLH values), we went on to compare the performance dissimilarity between the best-performing, (i.e. lowest NVV) hand of the healthy persons to the worst-performing (i.e. highest NVV) hand of PD patients. We found that the best-performing hand of PD subjects is still worse, in terms of NVV score, than the worst-performing hand of H subjects. To our knowledge, this is a result not mentioned in the literature in papers using high sample rate data. 
Focusing on the H and PD participants, we used each subject’s mean NVVALL score to categorize them as positive (PD) or negative (H). The receiver operating characteristic (ROC) curve had an area-under-the-curve value of 0.9354. The best cutoff threshold was NVVALL=0.0165 resulting in TN=90\% (18 subjects true negative), and TP=88\% (21 subjects true positive). These high percentages along with the results from the means testing prove that there is little overlap in the NVV values between the two populations and the NVV and its components can justifiably be used as a feature in a PD versus H classification model. 

\hlorange{NVV robustness}
We found $NVV$ scores to be consistent in multiple sessions for single subjects: seven of the \gls{PenH} subjects were re-tested a second or third time, over a period of several days. In six of the seven cases, means testing revealed no statistically significant differences in the subjects’ means over different testing sessions. The one volunteer who showed significant difference between the two sessions reported sleeping for only three hours the night before the second test session. Sleep deprivation is known to favor abnormal brain responses.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Supervised Machine Learning To Establish Discriminating Criteria}
\label{subsec:PenCTML}
To ultimately build a practical and ubiquitous tool which would be able to accurately assess upper limb tremor in \gls{PD} patients, 

\subsubsection{Fit of the Metrics as Discriminating Criteria}
\label{subsubsec:PenCTMetricsFit}
In table 

\subsubsection{Feature Selection for a Classification Model}
\label{subsubsec:PenCTFeatures}

\subsubsection{The Classification Model}
\label{subsubsec:PenCTClassification}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Discussion}
\label{subsec:PenCTDiscussion}


%%%%%%%%%%%%%%%%%%%% END OF PENCT %%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Results and Research Implications}
\label{sec:PenImplications}

Recent advance

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Limitations and Future Work}
\label{sec:PenLimitations}