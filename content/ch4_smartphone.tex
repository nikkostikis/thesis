\chapter{A Smartphone-based Tool for Parkinsonian Hand Tremor Assessment}
\label{ch:smartphone}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[OC]{\leftmark}
\fancyhead[EC]{\rightmark}
\cfoot{\thepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{General Approach}
\label{sec:smartGenApproach}
As discussed in section ~\ref{subsec:smartphones}, smartphones are becoming useful platforms in the hands of researchers, clinicians and medical professionals, who by developing sophisticated software and protocols can incorporate these devices into various stages of clinical practice. Even cheap devices are equipped with embedded inertial sensors, putting accelerometers and gyroscopes in the hands of every user. Combined with limitless connectivity and substantial processing power, they have the potential to become powerful quantification and monitoring tools.

Incentivized by the research discussed in ~\ref{subsec:smartphones}, including the work of LeMoyne (2010) and Deneault (2013), we set out to investigate how the sensors embedded in a smartphone would perform in a clinical setting or even home environment, and if they could provide any useful methods for \gls{PD} symptom quantification, identification and monitoring. Our approach was to use a popular smartphone device (iPhone) and incorporate it in the same setting as the normal scale-based examination, namely \gls{UPDRS} scoring, in a non-invasive, tireless manner. Having the six axes of innovation in mind (see ~\ref{sec:axes}), our objectives revolved around cost-efficiency, availability, ease of use, quality of diagnosis, effective monitoring and biobanking. 

Our approach was based on the following pillars: 

\begin{enumerate}
\item We focused on exploring the use of a ubiquitous device, such as a smartphone, with no additional software installed apart from its factory-installed operating system, and without the need to attach external hardware on it. 
\item We avoided making assumptions about the users, i.e. that they would have e-mail accounts or that they would be proficient enough to install and manage applications and configure complex settings. 
\item We explored solutions that would not require the presence of an expert to use, but would still produce replicable and accurate symptoms quantification. 
\item We opted for cloud based approaches that would ensure the persistence of the data and the availability of the results for post-processing and verification. 
\end{enumerate}

To validate our symptoms quantification approach we conducted two separate clinical trials: 

\begin{enumerate}
\item The first was a small-scale case control pilot clinical trial (\gls{SmartCT1}), which would serve as proof-of-concept for our approach (Kostikis et al, 2011). It consisted of 10 patients with idiopathic \gls{PD}, defined as group \gls{SmartMD1}, and 10 age-matched healthy volunteers, defined as group \gls{SmartH1}. The data collected were post-processed using signal processing and statistically analyzed, to calculate quantifying metrics and establish their significance. 
\item The second was a larger case control clinical trial (\gls{SmartCT2}), were 23 patients with idiopathic \gls{PD}, defined as group \gls{SmartPD2}, and 20 age-matched healthy volunteers, defined as group \gls{SmartH2}, were recruited. In a preliminary validation study, we used the data collected from \gls{SmartPD2} to compare the quantification calculated by our tool, to the patients' \gls{UPDRS} scores (Kostikis et al, 2014). Later on, both the \gls{SmartPD2} and \gls{SmartH2} groups' data were processed and used to perform statistical analysis and build machine learning models to establish our tool's potential as a classification platform for \gls{PD} patients (Kostikis et al, 2015). During the second clinical trial we also conducted a small longitudinal trial (\gls{SmartCT2L}) recruiting two idiopathic \gls{PD} patients, defined as \gls{SmartPD2L}. They were inpatients and were screened with our tool twice, once before, and once after medication. 
\end{enumerate}

In the following section we will describe the smartphone-based clinical trials we conducted, present the data processing pipeline applied in each trial and discuss the results obtained in each case, and the implications derived from our smartphone-based \gls{PD} symptoms quantification approach. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{SmartCT1}
\label{sec:SmartCT1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Protocol}
\label{subsec:SmartCT1Protocol}

\subsubsection{Rationale}
\label{subsubsec:smartCT1Rationale}
In section \ref{sec:accelerometry} we reviewed the literature proving that accelerometers are great means of studying human motor behavior and quantifying symptoms of movement disorders. In paragraph \ref{subsec:smartphones} we reviewed the papers that proved smartphones featuring Inertial Measurement Units (\gls{IMU}) sensors could be considered viable options for quantifying and measuring \gls{PD} motor symptoms.

Although accelerometers themselves and accelerometry-enabled smartphones were proven to work, the rationale of this clinical trial was to test the accuracy of a simple web-based tool in distinguishing healthy individuals from \gls{PD} patients, by assessing upper extremity rest and action postural tremor (see section \ref{subsec:tremor}) for a few seconds. Up until the inception of the trial's context by our team (late 2010), resources such as IMU sensors were only available in a mobile platform like Apple's iOS and Google's Android, through native applications, developed specifically for the particular target platform. Such an application would have to be downloaded and installed to properly function. Our approach was to harness a recently available (at the time) JavaScript specification, supported in Apple's iOS 4.2 Safari browser\footnote{DeviceOrientationEvent Specification, Accessed 18/09/2018 at: http://dev.w3.org/geo/api/spec-source-orientation.html}. Opting for a web-based solution meant that the user could follow our protocol without being required to install any application or even own the mobile device. A web-based solution built on a widely adopted specification would also mean that our tool would be compatible out of the box with a vast range of devices, with varying physical characteristics and operating systems. Finally, the web-based solution allowed us to seamlessly send the collected signal upon completion of the recording, absolving the user from the responsibility to handle the data and send them via e-mail, or be involved in any other way in the signal collection and transmission. 

Another novelty at the time (late 2010) was the combination of gyroscope as well as accelerometer signals. We were specifically interested in obtaining both acceleration and rotational velocity data because observations of patients with movement disorders show that tremor in their upper extremities may have a significant rotational component.

We chose to conduct a control study and not a one-population validation study because there was complete lack of literature evidence that this method of collecting inertial signals would work, or even be robust enough for us to gather usable data and detection of anomaly would be the first step before attempting to evaluate its severity. 

Therefore, the expected outcome of \gls{SmartCT1} was to collect data using a novel tool on a small target population (\gls{SmartMD1}), examine the signals, calculate basic metrics and explore the statistical significance of the metrics when compared to a size-matched control population (\gls{SmartH1}). Most importantly, we wanted to gain significant insight concerning the optimization of the protocol of our next scheduled larger clinical trial (\gls{SmartCT2}).

\subsubsection{Volunteers}
\label{subsubsec:smartCT1Volunteers}
%--------------------------------------->>>>>>>>>>
%--------------------------------------->>>>>>>>>>
%--------------------------------------->>>>>>>>>>
%--------------------------------------->>>>>>>>>>
To conduct \gls{SmartCT1} we recruited 20 volunteers. Ten of them were healthy control subjects (\gls{SmartH1}) and 10 patients (\gls{SmartMD1}). , referred to as the Movement Disorder (MD) group, recruited from the outpatient clinic of the 1st Department of Neurology at the Aristotle University of Thessaloniki. All subjects agreed to participate in this research after a detailed explanation of its aims and of the testing procedure. Subjects 1-8 in the MD group were Parkinson’s patients. Subjects 9 and 10 suffered from cerebellar and psychogenic tremor, respectively. All MD subjects were under medication.  

(\textcolor{BurntOrange}{Table X Demographics of the CT1 population}).

\subsubsection{Hardware And Software Setup}
\label{subsubsec:smartCT1SetUp}
Our setup consists of four essential components:
1. An iPhone 4 with iOS 4.2 or later, with Internet access enabled,
2. A web site which collects data from the phone’s sensors when visited by the user,
3. A web server which  hosts the site and stores measurements,
4. Software for processing the signals received at the server.
Our web-based application is intended for use on any phone equipped with an accelerometer and a gyroscope. We expect that by combining acceleration and angular velocity data we may be able to improve detection of movement disorders by accessing rotational components of hand tremor. We chose to experiment with the iPhone because its operating system, iOS 4.2, incorporates Javascript APIs which make it possible to read the phone’s sensors through a website. That means that in order to read an iPhone’s 3DOF acceleration, $a_x,a_y,a_z$, orientation, $θ_x,θ_y,θ_z$,  and angular velocity, $ω_x,ω_y,ω_z$,  one may simply build a website and ask the user to visit it, which is what we have done.
A web-based interface also makes our approach platform independent. The trade-off is that the necessary APIs [10] are currently available only in iOS 4.2; however, there are indications [11] that other smartphone operating systems, (e.g., Android) will eventually support the same interface.
The website we set up to collect the data can be hosted by any web server running php. A screenshot is shown in Fig. 1. The website’s size (what the user will download) is only about 10 KB. The site is currently used to support small-scale clinical tests, and can be accessed at [12]. The data are automatically posted and saved on the server (in text files of less than 40KB, typically), without having to store them locally in a file which the user will then sent by e-mail. 
Operationally, a user who wants to perform a measurement must have internet access enabled on their phone, and screen orientation must be “locked” to avoid mislabeling the data. The user then visits the website, optionally enters a few pieces of information (see Fig. 1), and then clicks on a link to start transmitting accelerometer and gyroscope data to the site. After a delay of 3 seconds, to allow the user to position the device as desired, data are collected for 12 seconds and then automatically submitted to the server, where they are saved in a file. The user is then redirected to the initial page, and may perform additional tests. At the server, the data are processed to extract information about possible movement disorders. Currently, that processing is done via a separate MATLAB application; however, our plan is to integrate its execution into the website, so that the results may be automatically obtained and communicated back to the user and/or their physician.  

To collect our acceleration and rotational velocity signals for this work we used a setup similar to [3]:
1.	An iPhone 4S with iOS 6 or later, with Internet access enabled,
2.	A web site to collect data from the phone’s sensors,
3.	A web server to host the site and store the measurements,
4.	Software for processing the signals received at the server.
Our web-based application (web-app) is intended for use on any smartphone equipped with an accelerometer and/or a gyroscope. We expect that by combining acceleration and rotation rate data we may be able to improve detection of movement disorders by accessing rotational components of hand tremor. 
The web-app consists of three php files (index, machine, main). When the user visits the appropriate URL [16] using their phone, they are asked to enter an identifier, which does not have to be their name, the type of posture they will be in (hands extended, hands at rest, hands in action or hands in front of the chest), and the hand (left or right) their device is on. The user then presses a virtual button (link), which will result in a php session being created and, after a 3 second-delay, the readings from the sensors will automatically start being recorded. The recording procedure lasts 30 seconds, however the user can interrupt it at any time. The work in [3] used 12-second recorded signals. Here, we decided to increase the duration to 30 seconds after experimentation that showed that the longer signal gave vastly improved results under spectral analysis. Once the recording of the accelerometer and gyroscope readings is done, the data are transmitted to the server as simple text files for post processing. 
Although when we collected our first samples in 2011 the only smartphone to incorporate JavaScript APIs [19] to access the accelerometer and gyroscope was the iPhone, the latest version of Android (4.4, Kit Kat) has added this feature to its web browser, making every Android phone with the required sensors a suitable platform for our implementation “out of the box”. 

The UPDRS scores of the PD volunteers were assessed by the same physician (our third author), just before data collection. We attached an iPhone on our volunteers’ hands using the same custom-made mounting glove (Fig. 1) from [15] and [16]. It consists of a perforated case into which the phone “locks”, and a wrist-supporting glove, both commercially available. The glove fits tightly on the volunteer’s hand and the case is tightly sewn on the glove using non-elastic thread, ensuring the stability of the device on top of the hand. With the device attached, each participant had to maintain each of two prescribed postures for 30 seconds, while acceleration and gyroscope data was recorded by the phone. The two postures we used were the same ones used during the clinical evaluation: a) “Extended”, i.e., seated with both hands extended in front of the torso (Postural Tremor of the Hands, component 3.15 of the MDS-UPDRS) and b) “Rest”, i.e., seated with both hands placed on the arms of the chair (Rest Hand Tremor, component 3.17 of the MDS-UPDRS). The procedure was then repeated for the subject’s other hand, in the same two postures. In the following, we will specify the combination of a patient’s hand (Right of Left upper extremity) during each position as rR, rL, eR, and eL for rest-right, rest-left, extended-right, and extended-left, respectively.
The hardware setup was the same as the one used in our earlier work, [15] and [16]: 
1.	An iPhone 4S with the latest iOS, with Internet access enabled, and screen orientation locked in vertical,
2.	A web application to collect data from the smartphone’s sensors,
3.	A web server to host the site and store the signals, and
4.	A MATLAB application for processing the signals received at the server.
As per the protocol described earlier, the volunteers were asked to maintain certain postures for 30 seconds, during which the application automatically collected the accelerometer and gyroscope data and sent them to our server. We then used the data to extract features which quantify and characterize the subjects’ tremor levels. The signals were sampled at 20Hz, which is sufficient to identify events occurring at 9Hz or less [20], such as PD-induced tremor. 
Our web application, being written in PHP and JavaScript, is entirely independent of the client's hardware or software platform. It only demands basic prerequisites such as an embedded accelerometer and gyroscope and one of the most popular smartphone operating systems, iOS or Android. We successfully tested it on a Samsung Galaxy S4 and a Google Nexus 5, both running Android 4.4.2. 

\subsubsection{Collection Procedure}
\label{subsubsec:smartCT1Collection}
The regimen that had to be followed during all smartphone-based clinical trials was the same, albeit a few minor modifications after the first trial. 
Operationally, a user who wants to perform a measurement must have internet access enabled on their phone, and screen orientation must be “locked” to avoid mislabeling the data. The user then visits the website, optionally enters a few pieces of information (see Fig. 1), and then clicks on a link to start transmitting accelerometer and gyroscope data to the site. After a delay of 3 seconds, to allow the user to position the device as desired, data are collected for 12 seconds and then automatically submitted to the server, where they are saved in a file. The user is then redirected to the initial page, and may perform additional tests. At the server, the data are processed to extract information about possible movement disorders
To proceed with data collection we designed a custom mounting glove for the phone using a wrist protection glove and a hard case for the device (see Fig. 2). It is possible to forgo the glove and have the user simply hold the phone. However, in the initial stages of this work we wanted to standardize the phone’s posture as much as possible and to eliminate any possible effects from the action of the fingers gripping the phone.
During clinical tests, subjects were asked to wear the iPhone on their wrist, and sit with their arms extended horizontally in front of them, keeping that position for 12 seconds while data were recorded. The device was mounted on both their hands alternately, and each test was repeated at least twice for each subject. 

In this work we are initially interested in resting tremor so we asked the subjects to “wear” an iPhone (fitted on a glove as in [3]) on top of their hand while sitting in a chair comfortably and resting both their hands on their lap, keeping that position for 30 seconds. The device was mounted on both their hands alternately, and each test was repeated twice for each subject. Immediately prior to data collection, an experienced physician examined each subject and recorded their UPDRS scores, which were to be correlated with our quantitative measurements. 
The work in [3] used 12-second recorded signals. Here, we decided to increase the duration to 30 seconds after experimentation that showed that the longer signal gave vastly improved results under spectral analysis.

We attached an iPhone on our volunteers’ hands using the same custom-made mounting glove (Fig. 1) from [15] and [16]. It consists of a perforated case into which the phone “locks”, and a wrist-supporting glove, both commercially available. The glove fits tightly on the volunteer’s hand and the case is tightly sewn on the glove using non-elastic thread, ensuring the stability of the device on top of the hand. With the device attached, each participant had to maintain each of two prescribed postures for 30 seconds, while acceleration and gyroscope data was recorded by the phone. The two postures we used were the same ones used during the clinical evaluation: a) “Extended”, i.e., seated with both hands extended in front of the torso (Postural Tremor of the Hands, component 3.15 of the MDS-UPDRS) and b) “Rest”, i.e., seated with both hands placed on the arms of the chair (Rest Hand Tremor, component 3.17 of the MDS-UPDRS). The procedure was then repeated for the subject’s other hand, in the same two postures. In the following, we will specify the combination of a patient’s hand (Right of Left upper extremity) during each position as rR, rL, eR, and eL for rest-right, rest-left, extended-right, and extended-left, respectively.

As per the protocol described earlier, the volunteers were asked to maintain certain postures for 30 seconds, during which the application automatically collected the accelerometer and gyroscope data and sent them to our server. We then used the data to extract features which quantify and characterize the subjects’ tremor levels. The signals were sampled at 20Hz, which is sufficient to identify events occurring at 9Hz or less [20], such as PD-induced tremor. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Data Collected}
\label{subsec:SmartCT1Data}
During clinical tests, subjects were asked to wear the iPhone on their wrist, and sit with their arms extended horizontally in front of them, keeping that position for 12 seconds while data were recorded. The device was mounted on both their hands alternately, and each test was repeated at least twice for each subject. From the data obtained, we formed the subject’s acceleration vector, $\alpha(i) = [\alpha_{x}(i),\alpha_{y}(i),\alpha_{z}(i)]^{T}$ (in m/s2) and angular velocity vector $\omega(i) = [\omega_{x}(i),\omega_{y}(i),\omega_{z}(i)]^{T}$ (in rad/s), with i denoting discrete time. Typical profiles of the two vectors (magnitude squared) are shown in Fig. 3.
One challenge when using the iPhone’s current Javascript APIs is that the sampling rate (or rate at which the API may be triggered) is not adjustable, and stays at a default 20Hz, which is quite low. Furthermore, sampling of the on-board devices via JavaScript is subject to jitter (in some cases we measured a jitter of up to 5ms with a nominal sampling period of 50ms). In light of these considerations, we chose to explore very simple signal metrics (e.g., energy or power) for categorizing subjects as to whether they exhibited hand tremor or not. Specifically, we computed

\begin{equation}
m_{\alpha} = \frac{\sum_{i=1}^{N} \|\alpha(i)\|^{2} }{N}
\end{equation}

\begin{equation}
m_{\omega} = \frac{\sum_{i=1}^{N} \|\omega(i)\|^{2} }{N}
\end{equation}

where $N$ was the number of samples in the signal, and attempted to categorize subjects based on these two quantities. Here $m_{\alpha}$ and $m_{\omega}$ can be viewed as signal power, the signal being the length of the acceleration and rotational velocity vectors, respectively. Typical values of these metrics when the iPhone was at rest on the desktop were $m_{\alpha}=0.0127$ and  $m_{\omega}=0.0000$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Comparisons / Data Analysis / Results}
\label{subsec:SmartCT1Results}
The purpose of this first study was to collect data by integrating a smartphone, as seamlessly as possible, to specific items of the gold standard of clinical evaluation (\gls{UPDRS})

We first compared the mean values of the two metrics for our two populations, using all data (left and right hand) for each subject. The N population had an average acceleration power of 0.0915 (min=0.0338, max=0.1325), which was low compared to the MD mean of 0.1760. Statistical analysis (Mann-Whitney test) verified that differences between two populations were indeed significant. With respect to angular velocity power, the N population had a mean of 0.0039 (min=0.0020, max=0.0066), while the average for MD subjects was a much higher 0.0224. The 10th MD subject’s scores were much higher than the rest, and were excluded when calculating the mean for the MD group, in order to avoid “artificially” strong comparisons with the N group. As depicted in Figure 4, all MD subjects scored higher than the N-group (control) mean when considering the $m_{\omega}$ metric (in 4 cases they scored higher in both metrics).
The acceleration and angular velocity metrics we computed, generally agreed with the severity of hand tremor as observed clinically. Because of space constraints we only present data for the MD group as compared to the mean and maximum values from the N group. The corresponding data for the healthy subjects can be found in [13]. One of our goals was to see how well we can detect movement disorders (in this case, hand tremor) using mα and mω. Towards that end, we explored the possibility of identifying subjects with hand tremor via two simple criteria. The first was whether either of a subject’s mean measurements (mα, mω) were above a certain threshold, namely the highest mean score encountered in the N group. Because it is known that movement disorders typically affect one side of the patient more severely than the other, we re-calculated each metric using data only from each subject’s “worst” hand, i.e., the hand which scored highest in each metric. By doing so, the highest acceleration and angular velocity scores for healthy subjects were 0.1515 and 0.0092, respectively. The identification of patients’ worst performing hands by comparing average metrics for their left vs. right hand as described above, gave the same results regardless of the metric used (acceleration or rotational velocity), and correctly identified the worst hand of every patient except subject 4. The comparisons between the subjects’ mean scores for their worst-performing hand and the thresholds (maximum scores) obtained from the N group are described in Figure 5. The thresholding criterion correctly “labels” nine of the ten subjects as being in the MD group. The one exception was subject 8 who does suffer from Parkinson’s disease, but his symptoms include mostly bradykinesia and rigidity, as opposed to pronounced hand tremor. We note that if we were to judge based on  mω alone, then the same nine subjects would be categorized as MD, whereas only four subjects exceeded the mα acceleration threshold. A second criterion for comparing the MD and N populations was the difference in mα (and mω) between hands. A healthy subject is not expected to have very different left vs. right mean scores, while the opposite is often true for patients with movement disorders. The control group (N) had an average hand-to-hand difference of 0.0232 in mα (max=0.0514, min=0.0123, std. dev.=0.0117) whereas MD subjects had an average difference of 0.1572 (std. dev.=0.2629). The corresponding numbers for mω were 0.0031 (max=0.0053, min=0.0006, std. dev.=0.0016) for the N group and 0.0185 (std. dev.=0.0147) for the MD group. Again, nine of the MD subjects had mean differences which exceeded the maximum encountered in the N group in either mα or mω, or both; they were the same nine identified via thresholding on worst-hand scores (see [13] for individual scores).

%Implications and conclusion
We explored the use of recently-available smartphone technology for the purpose of diagnosing and quantifying the postural tremor which characterizes movement disorders such as Parkinson’s disease. Our method is based on the use of on-board accelerometer and gyroscope which are currently found in many smartphones and can be accessed via the web. Unlike previously proposed approaches, ours i) is web-based, meaning that the user simply visits a web page without installing software on their phone, or handling the data being collected, and ii) uses accelerometer and gyroscope data simultaneously in order to classify patients based on very simple signal metrics and thresholding. 
We tested our approach in a small clinical trial involving twenty subjects (half of them being the control group) and found that we correctly categorize nine of the ten patients, based on the power of their acceleration and rotational velocity signals, or the differences in performance between their two hands. The gyroscope data appear to be particularly useful in that regard.
Our goal is to ultimately make our web application freely available on a dedicated server which will receive data and return the results to the user and their physician (securely, over SSL), for the purposes of providing remote diagnostic decision support and tracking of the patient’s condition over time. Towards that end, we are currently in the process of evaluating our approach in larger trials, with data obtained from additional types of subject movements and postures, alternative signal metrics, and comparison of the resulting scores to the patients’ UPDRS ratings. 
The fact that we are using a JavaScript API to control the smartphone’s hardware (as opposed to its native programming platform) does give us flexibility but deprives us of certain benefits such as adjusting the sampling rate. To circumvent this problem, we are also pursuing an Objective C application which will be used to repeat the same clinical tests for comparison, as well as more sophisticated signal processing methods (including reconstruction for irregularly sampled signals [14], [15]). 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{SmartCT2}
\label{sec:SmartCT2}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Protocol}
\label{subsec:SmartCT2Protocol}

\subsubsection{Rationale}
\label{subsubsec:smartCT2Rationale}
Researchers frequently look for new ways to facilitate the work of physicians and doctors, for the purposes of increased accuracy, speed or accessibility. Towards that end, smartphones and smartphone-like devices offer a tantalizing platform since they contain embedded motion sensors, including accelerometers and gyroscopes, making it possible to detect even slight displacements of the device. Moreover, phones that feature such sensors are now commonplace, and it is relatively easy to utilize a smartphone to detect movement anomalies that appear in disorders such as Parkinson’s disease. Accelerometers have been used successfully for characterizing tremor [1] and are particularly useful in measuring “resting” tremor (i.e., with the patient’s hand being at rest against their body), and thus objectively quantifying one of the condition’s predominant attributes. However, the advent of new technology does not remove the need for existing qualitative clinical assessment methods administered by a physician; on the contrary, it appears that clinical assessment will continue to be a mainstay in the diagnosis and tracking of movement disorders. Concerning Parkinson’s disease in particular, clinical assessment typically uses the so-called UPDRS (Unified Parkinson’s Disease Rating Scale) scoring method [2], in which the physician assigns numerical scores based on qualitative observations of the patient in various postures. 

This paper is a continuation of our previous work [3]; its main contribution is a statistical comparison between signal-based methods of quantifying Parkinsonian tremor using a smartphone, and the UPDRS scores assigned by a physician specialist, in order to validate our previous approach. We acquired hand tremor signals from twenty-three patients using an iPhone and computed the correlation (Pearson product-moment) between the metrics under consideration and the patients’ UPDRS scores regarding hand tremor. Our results indicate a strong correlation (r>0.7) with high statistical significance (p<0.01), which suggests that our quantitative methods of measuring Parkinsonian hand tremor [3] show promise as a means of systematically tracking that component of the disease, possibly as part of a clinical exam or in telemedicine applications. 

The use of the embedded sensors in smartphones has introduced new accessibility options, without sacrificing efficiency, with the added bonus of the gyroscope, which is present in an increasing number of devices. LeMoyne et al. [15] were the first to introduce the use of a smartphone to collect acceleration data through an application installed on the device and send the data via e-mail to a remote computer for post-processing. 
In earlier work [3], we used [15] as a starting point and built a similar smartphone-based diagnostic tool for the detection and tracking of movement disorders. The novelty of our effort was that it was completely web-based, requiring from the patient nothing more than tapping on a web link while having the phone mounted on his/her hand. Moreover, ours is the only implementation that uses both the accelerometer and the gyroscope embedded in a smartphone. Being web-based, our tool [16] is independent of the operating system on the device and works on iPhone as well as on Android v4.4 devices. 

The authors of [17] took a very similar approach to ours: an application collects the acceleration data from an iPhone and posts them online for assessment, while the presence of a physician on site is not necessary. More recently, other researchers used a BlackBerry Storm phone to measure tremor, implementing the signal processing algorithms on-board the device with good results [18]. 

%JBHI Rationale

(PD) is a chronic neurodegenerative disorder, affecting more than 1\% of people over 55 and more than 3\% of those over 75 years of age [1]. It is caused by low and falling dopamine levels. Its symptoms are extensively documented, including tremor, bradykinesia, rigidity, postural instability and impaired cognitive function [2], however the reason why the dopaminergic neurons die (resulting in abnormally low dopamine levels) is unknown. Thus, current treatments only focus on alleviating the symptoms and improving the patients’ daily life. 
The typical clinical examination of a PD patient involves a standardized procedure where the physician evaluates the performance of the patients on a scale of 0-4, observing them in postures and tasks described in the Unified Parkinson’s Disease Rating Scale (UPDRS) [3]. When motor impairment is present, physicians may use the results of Electromyography (EMG) or imaging scans such as Positron Emission Tomography (PET) and Single-Photon Emission Computed Tomography (SPECT) to exclude other reasons for the symptoms before diagnosing PD, but these techniques do not constitute PD assessment tools per se. 
Tremor is not the main quality of life constraining-aspect of the disease [4], but responds well to dopaminergic medication; as such, its objective quantification can provide useful feedback on the efficacy of the treatment regimen. Because of that, researchers have turned to platforms involving wearable accelerometers to help them assess PD tremor, with relative success [5],[6],[7],[8],[9]. 
When it comes to PD, it is important to be able to assess patients accurately and frequently in order to adjust their treatment as necessary when variations in the severity of the symptoms occur. Unfortunately, in addition to the time and costs involved, it is difficult for most patients (even more so for those in rural areas), to be monitored frequently by a specialized physician. This creates the need for tools that can aid the physician by assessing a patient’s condition remotely, and that are practical and easy to use. 
In the last few years, researchers have explored the ability of smartphones to quantify PD tremor accurately [10],[11],[12]. These devices are now ubiquitous with a suite of on-board sensors (including accelerometers) and wireless connectivity. They are also easy to use compared with most wearable accelerometer solutions previously developed. As such, they have been making their way into medical research aimed at developing mobile tools for aiding the physician [13]. 
Although scientifically important, none of the accelerometer- or smartphone-based methods proposed to date have made their way into mainstream clinical practice. The last decade there have been efforts to create platforms incorporating inertial measurement sensors into scalable body sensor networks, with wireless connectivity and real-time on-node signal processing. Approaches like SHIMMER, Kinesia and Xsens do provide researchers with valuable information, however they have high complexity in terms of hardware and software, high cost, and lack standardized, approved and widely accepted protocols. Additionally, they can hardly be considered ubiquitous. 
The goal of this work is to investigate the use of a smartphone-based tool for assessing PD induced hand tremor. Our approach involves using the phone’s embedded accelerometer and gyroscope sensors to quantify PD hand tremor. Operationally, the patient simply visits a web site [14] and takes up simple postures much like those used in standardized clinical exams, with the smartphone mounted on their hand. The data thus recorded can then be used to classify a subject as healthy or not, and to track the severity of the tremor in PD patients. 
Preliminary versions of this work can be found in [15] and [16], where we presented proof-of-concept results for the tool discussed here. This paper substantially differs from and extends our previous work by i) including additional samples from healthy subjects which are age-matched to the PD patients used in our study, ii) including data on a small sample of patients off medication in order to quantitatively track the severity of their hand tremor, iii) exploring the correlation between our quantitative metrics results and the patients’ (subjective) clinical examination for all supported postures, and iv) using a machine learning feature classification approach to choose those metrics which are better at distinguishing between pathological and healthy signals, thus  increase our method’s accuracy. The accuracy in separating healthy from PD subjects attained in this work is on par with other works using smartphones’ accelerometers and short-duration data [12]. It is also very close to the sensitivity and specificity achieved in [17], where the authors used sensors of the SHIMMER platform to perform mobile gait analysis. There are works that achieve near 100\% accuracy but do so using day-long signals [18] which may not be practical in our setting. High accuracy (98.5\% sensitivity, 97.5\% specificity) is also achieved using smartphone accelerometer-based gait analysis, with a combination of tests and metrics [19]. 
The proposed method has been implemented in the form of an app and is available for use on any smartphone with iOS or Android installed, without the need for any downloads or memory-consuming installations [14]. It can be offered as a web-service, so that developers can build their own applications around it and extend its functionality. Our approach does not require the presence of an expert or any kind of special equipment to conduct measurements. It transmits data in real time via TCP/IP, connecting the patient to his physician with no delays, and can benefit the research community by providing anonymized information on PD hand tremor profiles. 

The remainder of this paper is structured as follows. In Section II we describe our experimental setup, the subjects used in our study and the metrics calculated based on the signal(s) collected from each subject. Section III contains the main results, including statistical analyses of the subjects’ scores under each metric, correlation with the subjects’ clinical “picture”, and a machine-learning-based discrimination scheme for separating healthy from PD subjects. Section IV summarizes our findings and discusses their implications for medical practice, as well as future work.

\subsubsection{Volunteers}
\label{subsubsec:smartCT2Volunteers}
The twenty-three subjects participating in this study were all Parkinson's disease patients recruited from the outpatient clinic of the 1st Department of Neurology at the Aristotle University of Thessaloniki. All agreed to participate in this research after a detailed explanation of its aims and of the testing procedure. All patients were under treatment. In this work we are initially interested in resting tremor so we asked the subjects to ``wear'' an iPhone (fitted on a glove as in [3]) on top of their hand while sitting in a chair comfortably and resting both their hands on their lap, keeping that position for 30 seconds. The device was mounted on both their hands alternately, and each test was repeated twice for each subject. Immediately prior to data collection, an experienced physician examined each subject and recorded their UPDRS scores, which were to be correlated with our quantitative measurements. 

\subsubsection{SmartCT2L Rationale}
\label{subsubsec:smartCT2LRationale}
The 23 volunteers of the PD group who underwent the smartphone-based tremor measuring procedure were under medication, but the timespan from their last dose of L-DOPA was anywhere from 1 to 4 hours when they were tested. That means that some of them were at the peak of the drug’s effect while for others this was not the case. With an eye towards tracking the progression of PD, we wanted to see how our metrics would “react” to an alteration in a patient’s condition, such as that brought on by medication intake. We observed two PD volunteers, referred to as the PDDN group, who stayed in the clinic overnight and followed our experimental protocol both “off” and “on” medication (i.e., right before taking their medication in the morning and one hour after that). In Table VI we present the percent differences “on”-“off” in the four metrics, along with the UPDRS scores (“off” and “on”) for both PDDN subjects. We would expect those differences to be negative because we expect higher metric scores (more pronounced tremor) while off-medication or in a de novo state, and lower after the drug ingestion (“on”). 
From the UPDRS scores of the two volunteers it is clear that these two patients did not suffer from severe hand tremor. Their physician observed that the medication improved mostly the patients’ rigidity (which is not measured by our tool) and less so their tremor. However, it is encouraging to note that the readings of the smartphone’s sensors respond well and follow the expected negative trend of the changes in the UPDRS scores in the “on” state. The only discrepancy is observed in the eR position of volunteer B for all metrics, however for that position there were also no observed clinical changes in the UPDRS “on”-“off” as well. 

\subsubsection{SmartCT2L Volunteers}
\label{subsubsec:smartCT2LVolunteers}
We recruited twenty-five PD patients from the outpatient clinic of the 1st Department of Neurology at the Aristotle University of Thessaloniki. They all agreed to participate after they were offered a detailed explanation of the study’s procedure and goals. All of them were right-handed, under L-DOPA treatment and suffering from PD for more than two years. During the study, two of them were hospitalized overnight so that they could be tested in the morning before they received their medication, to approximate de novo PD patients. Those two will be referred as our PDDN group, while the PD group comprises the other twenty-three (see Table I for patients’ information). 
The control group for the study, labeled as group H, contains twenty healthy volunteers, none of whom suffered from a movement disorder, hypertension or diabetes. They were screened for several health conditions which could exclude them from the study, such as hypertension or any movement disorder. They were also notified of the procedure and the purpose of the study before agreeing to participate. Grouping information on all participants of the study is provided in Table II. 
The ages of the two main groups were mean-tested with the non-parametric Mann-Whitney test and were found not to be statistically different at the 1\% significance level, therefore the groups can be considered age-matched. 

\subsubsection{Hardware And Software Setup}
\label{subsubsec:smartCT2SetUp}
Our setup consists of four essential components:
1. An iPhone 4 with iOS 4.2 or later, with Internet access enabled,
2. A web site which collects data from the phone’s sensors when visited by the user,
3. A web server which  hosts the site and stores measurements,
4. Software for processing the signals received at the server.



$\alpha(i) = [\alpha_{x}(i),\alpha_{y}(i),\alpha_{z}(i)]^{T}$
$\omega(i) = [\omega_{x}(i),\omega_{y}(i),\omega_{z}(i)]^{T}$

%Equations

\begin{equation}
mag_{\alpha} = \sum_{i=1}^{N} \|\alpha(i)\|^{2}
\end{equation}

\begin{equation}
mag_{\omega} = \sum_{i=1}^{N} \|\omega(i)\|^{2}
\end{equation}

\begin{equation}
sd_{\alpha} = \sum_{i=1}^{N-1}\sum_{\kappa \in \{x,y,z\}} |\alpha_{\kappa}(i) - \alpha_{\kappa}(i+1)|
\end{equation}

\begin{equation}
mAmp_{\omega} = \sum_{\kappa \in \{x,y,z\}} \max_{4 \leq \xi \leq 7} \hat{\omega}_{\kappa}(\xi)
\end{equation}



%The goal of this work is to investigate the use of a smartphone-based tool for assessing PD induced hand tremor. Our approach involves using the phone’s embedded accelerometer and gyroscope sensors to quantify PD hand tremor. Operationally, the patient simply visits a web site [14] and takes up simple postures much like those used in standardized clinical exams, with the smartphone mounted on their hand. The data thus recorded can then be used to classify a subject as healthy or not, and to track the severity of the tremor in PD patients. 
%Preliminary versions of this work can be found in [15] and [16], where we presented proof-of-concept results for the tool discussed here. This paper substantially differs from and extends our previous work by i) including additional samples from healthy subjects which are age-matched to the PD patients used in our study, ii) including data on a small sample of patients off medication in order to quantitatively track the severity of their hand tremor, iii) exploring the correlation between our quantitative metrics results and the patients’ (subjective) clinical examination for all supported postures, and iv) using a machine learning feature classification approach to choose those metrics which are better at distinguishing between pathological and healthy signals, thus  increase our method’s accuracy. The accuracy in separating healthy from PD subjects attained in this work is on par with other works using smartphones’ accelerometers and short-duration data [12]. It is also very close to the sensitivity and specificity achieved in [17], where the authors used sensors of the SHIMMER platform to perform mobile gait analysis. There are works that achieve near 100\% accuracy but do so using day-long signals [18] which may not be practical in our setting. High accuracy (98.5\% sensitivity, 97.5\% specificity) is also achieved using smartphone accelerometer-based gait analysis, with a combination of tests and metrics [19]. 
%The proposed method has been implemented in the form of a website and is available for use on any smartphone with iOS or Android installed, without the need for any downloads or memory-consuming installations [14]. It can be offered as a web-service, so that developers can build their own applications around it and extend its functionality. Our approach does not require the presence of an expert or any kind of special equipment to conduct measurements. It transmits data in real time via TCP/IP, connecting the patient to his physician with no delays, and can benefit the research community by providing anonymized information on PD hand tremor profiles. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Hardware}
%\label{subsec:hardware}
%The UPDRS scores of the PD volunteers were assessed by the same physician (our third author), just before data collection. We attached an iPhone on our volunteers’ hands using the same custom-made mounting glove (Fig. 1) from [15] and [16]. It consists of a perforated case into which the phone “locks”, and a wrist-supporting glove, both commercially available. The glove fits tightly on the volunteer’s hand and the case is tightly sewn on the glove using non-elastic thread, ensuring the stability of the device on top of the hand. With the device attached, each participant had to maintain each of two prescribed postures for 30 seconds, while acceleration and gyroscope data was recorded by the phone. The two postures we used were the same ones used during the clinical evaluation: a) “Extended”, i.e., seated with both hands extended in front of the torso (Postural Tremor of the Hands, component 3.15 of the MDS-UPDRS) and b) “Rest”, i.e., seated with both hands placed on the arms of the chair (Rest Hand Tremor, component 3.17 of the MDS-UPDRS). The procedure was then repeated for the subject’s other hand, in the same two postures. In the following, we will specify the combination of a patient’s hand (Right of Left upper extremity) during each position as rR, rL, eR, and eL for rest-right, rest-left, extended-right, and extended-left, respectively.
%The hardware setup was the same as the one used in our earlier work, [15] and [16]: 
%1.	An iPhone 4S with the latest iOS, with Internet access enabled, and screen orientation locked in vertical,
%2.	A web application to collect data from the smartphone’s sensors,
%3.	A web server to host the site and store the signals, and
%4.	A MATLAB application for processing the signals received at the server.
%As per the protocol described earlier, the volunteers were asked to maintain certain postures for 30 seconds, during which the application automatically collected the accelerometer and gyroscope data and sent them to our server. We then used the data to extract features which quantify and characterize the subjects’ tremor levels. The signals were sampled at 20Hz, which is sufficient to identify events occurring at 9Hz or less [20], such as PD-induced tremor. Our web application, being written in PHP and JavaScript, is entirely independent of the client’s hardware or software platform. It only demands basic prerequisites such as an embedded accelerometer and gyroscope and one of the most popular smartphone operating systems, iOS or Android. We successfully tested it on a Samsung Galaxy S4 and a Google Nexus 5, both running Android 4.4.2. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Software}
%\label{subsec:software}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Data Collection}
%\label{subsec:dataCollection}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Signal and Metrics}
\label{subsec:smartSignalMetrics}
%For each volunteer’s session we obtained two signals from the phone’s sensors, the acceleration vector 〖α(i)=[α_x (i),α_y (i),α_z (i)]〗^T (in m/s2) and the  rotational velocity vector 〖ω(i)=[ω_x (i),ω_y (i),ω_z (i)]〗^T (in deg/s), with i denoting discrete time. The rotational velocity in practice should be more information-rich because it is constructed using both accelerometer and gyro data and is expected to capture more of the characteristics of the tremor. We applied a band-pass filter with cutoff frequencies of 1.5Hz and 9.5Hz, in order to exclude noise due to breathing, pulse, or any high-frequency sudden movements during the recordings. The spectral analysis of α(i) and ω(i) of a PD volunteer with typical Parkinsonian tremor is shown in figure 2. As expected, her acceleration and rotational velocity signal amplitude peaks at about 3-5Hz, which is consistent with the literature [20]. We used the acceleration and rotational velocity signals as in [16], to compute the following four metrics for each session:
%where: 〖mag〗_α and 〖mag〗_ω are the sums of squared magnitudes of the acceleration, and the rotation rate vector respectively, and 〖sd〗_α, is the sum of absolute differences in the acceleration vector, summed over each of the three axes, x, y, and z. To compute the 〖mAmp〗_ω metric (4) we initially obtained the magnitude of the Fourier transform of each of the three axial components of the rotation vector ω(i), defined as (ω_κ ) ̂(ξ), κ∈{x,y,z}. We then determined each component’s maximum in the 4≦ ξ ≦7 Hz range (that range being consistent with the frequency of Parkinsonian tremor) and summed the three maxima [16]. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Signal Processing}
\label{sec:smartSignalProcessing}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Means Testing}
\label{subsec:smartMeansTesting}
%Since our goal is to facilitate monitoring and diagnosis of PD-induced tremor, it is essential to establish that the metrics described in the previous section can be useful in differentiating the PD vs H populations. We used the non-parametric Mann-Whitney test to establish that the two populations have statistically different means in all four metrics on all four postures, rR, rL, eR, eL. As shown in Table III, all between-groups tests found significant differences between the mean scores of the metrics of the H volunteers compared to the mean of the PD volunteers. This suggests that the two populations (H and PD) have statistically different scores under every one of the signal metrics computed, and one may attempt to differentiate H vs PD subjects based on one or more of those metrics.
% There was no statistical difference in the subjects’ left vs. right mean scores within each group (see Table IX in Appendix). It is typical for PD patients to manifest the disease’s symptoms with some laterality, i.e., to a greater degree on one side, right or left. That is indeed the case with our PD volunteers because 19 of the 23 have differences between the sums of the UPDRS components concerning right vs left hand tremor indicating laterality of motor impairment. Although clinically observable, the Mann-Whitney test for the summed UPDRS scores for right vs left hands yields no statistical difference, with p=0.7327. In order to identify the laterality statistically, for each metric we summed the scores of both postures for right and left hand separately and calculated the absolute differences between them. As shown in the last four rows of Table III, for each metric, the absolute differences between hands for the PD group is statistically different from those of the H group. That means that the amount of difference between hands is not the same for PD and H, presumably due to the disease’s laterality.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Features Identification}
\label{subsec:smartFeaturesIdentification}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Correlation with Scale-based Metrics}
\label{subsec:smartCorrelation}
%In previous work [16] we attempted to establish the validity of our smartphone-based method of upper limb parkinsonian tremor quantification by running a Pearson product-moment correlation analysis between the UPDRS scores of the PD volunteers and their respective signal metrics. Table IV contains the results of the correlation analysis for the Rest posture scores. The numbers are slightly different from our previous study because the signals are now band pass filtered, as previously explained. In [16] we used the Rest posture data only, whereas here we were also interested in the Extension posture data for both hands. The correlation analysis of the Extension posture data (Table V) yields low coefficients (r<0.6) with low confidence (p>0.01). The results are better for the right hand but generally do not suggest good correlation between the UPDRS scores and the smartphone metrics. These findings show a connection between the manifestation of the action hand tremor and the hardware experimental setup. The fact that the resting tremor is identified consistently, whereas in the extended posture the measured tremor correlates weakly with the clinical assessment, is probably related to the effect of the mass of the smartphone on the dynamics of the hand/arm system.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Machine Learning Model}
\label{sec:smartMachineLearning}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussion}
\label{sec:smartDiscussion}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{OFF - State Trials}
\label{subsec:smartOffState}
%The 23 volunteers of the PD group who underwent the smartphone-based tremor measuring procedure were under medication, but the timespan from their last dose of L-DOPA was anywhere from 1 to 4 hours when they were tested. That means that some of them were at the peak of the drug’s effect while for others this was not the case. With an eye towards tracking the progression of PD, we wanted to see how our metrics would “react” to an alteration in a patient’s condition, such as that brought on by medication intake. We observed two PD volunteers, referred to as the PDDN group, who stayed in the clinic overnight and followed our experimental protocol both “off” and “on” medication (i.e., right before taking their medication in the morning and one hour after that). In Table VI we present the percent differences “on”-“off” in the four metrics, along with the UPDRS scores (“off” and “on”) for both PDDN subjects. We would expect those differences to be negative because we expect higher metric scores (more pronounced tremor) while off-medication or in a de novo state, and lower after the drug ingestion (“on”). From the UPDRS scores of the two volunteers it is clear that these two patients did not suffer from severe hand tremor. Their physician observed that the medication improved mostly the patients’ rigidity (which is not measured by our tool) and less so their tremor. However, it is encouraging to note that the readings of the smartphone’s sensors respond well and follow the expected negative trend of the changes in the UPDRS scores in the “on” state. The only discrepancy is observed in the eR position of volunteer B for all metrics, however for that position there were also no observed clinical changes in the UPDRS “on”-“off” as well.